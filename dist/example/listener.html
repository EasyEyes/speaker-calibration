<!DOCTYPE html>
<html class="no-js" lang="">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>Listener</title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      http-equiv="Delegate-CH"
      content="sec-ch-ua-full-version-list https://cloud.51degrees.com; sec-ch-ua-model https://cloud.51degrees.com; sec-ch-ua-platform https://cloud.51degrees.com; sec-ch-ua-platform-version https://cloud.51degrees.com"
    />

    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />

    <!-- CSS -->
    <link href="../example/styles.css" rel="stylesheet" typ="text/css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />

    <!--<script src="https://www.unpkg.com/sound-check">  </script>-->
    <script async src="https://cloud.51degrees.com/api/v4/AQQCMqYvMsovbwZ520g.js"></script>
    <script src="../main.js"></script>
  </head>

  <body>
    <!--[if lt IE 8]>
      <p class="browserupgrade">
        You are using an <strong>outdated</strong> browser. Please
        <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.
      </p>
    <![endif]-->
    <div class="container">
      <h1>Sound Calibration</h1>
      <p class="lead" id="message">
        We will now calibrate your computer's loudspeaker to enable accurate sound production.

        <br /><br />REMOVE HEADPHONES. It won't work with headphones. If you're using headphones,
        disconnect them now so your computer uses its loudspeaker.

        <br /><br />UNBLOCK THE MICROPHONE. When this phone is held in its usual vertical
        orientation, the microphone is in the BOTTOM edge. For accurate sound calibration, make sure
        nothing blocks the microphone. Remove any protective case.

        <br /><br />LAY IT ON THE TABLE, AIMING MICROPHONE AT COMPUTER. First, rotate this phone to
        landscape orientation, so display is short and wide. This text will rotate to remain
        upright. Now place the phone on the table to the right or left of your computer, aiming the
        microphone at your computer.

        <br /><br />WHEN READY, CLICK OK. Then a pop up will appear here asking for your permission
        to use the microphone. When you grant permission the calibration will begin.
      </p>
      <div>
        <div class="col-6">
          <button id="calibrationBeginButton" type="button" class="btn btn-primary">Ok</button>
        </div>
        <div class="col-6">
          <div id="display"></div>
        </div>
      </div>
    </div>
    <script type="text/javascript">
      const listenerParameters = {
        targetElementId: 'display',
      };
      document.getElementById('calibrationBeginButton').onclick = () => {
        window.listener = new speakerCalibrator.Listener(listenerParameters);
        console.log(window.listener);
        document.querySelector('#calibrationBeginButton').style.display = 'none';
        document.querySelector('#message').innerText =
          'Calibration in progress, please hold your phone steady.';
      };
    </script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
